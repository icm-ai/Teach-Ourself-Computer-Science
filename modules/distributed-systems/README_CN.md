# 分布式系统

[English](README.md) | 简体中文

## 概述

设计跨多台机器的容错系统。本模块涵盖分布式一致性、复制、分区、时钟和共识算法。

## 为何要学？

如今，**多数**系统都是分布式的。

随着计算机在数量上的增加，计算机同样开始**分散**。尽管商业公司过去愿意购买越来越大的大型机，现在的典型情况是，甚至很小的应用程序都同时在多台机器上运行。思考这样做的利弊权衡，即是分布式系统的研究所在，也是越来越重要的一项技能。

## 前置要求

**强烈推荐：**

- 计算机网络 - 理解网络通信
- 操作系统 - 理解并发、进程等
- 数据库 - 分布式系统的许多概念来自数据库

**建议学习顺序：** 先学计算机网络和操作系统，再学分布式系统。

## 编程语言

- **Go** - 原生支持并发，适合分布式编程
- **Java** - 许多分布式系统用 Java 实现
- **Python** - 快速原型开发
- **Rust** - 高性能分布式系统

## 推荐资源

### 教材

#### 《数据密集型应用系统设计》（DDIA）

**作者：** Martin Kleppmann

**中文版：** [《数据密集型应用系统设计》](https://book.douban.com/subject/30329536/)

**英文版：** Designing Data-Intensive Applications

**难度：** 中级

**为什么选择这本书：**

与传统的教科书相比，它是一本为实践者设计的具有很高的可读性的书，并且保持了深度和严谨性。这本书是我们的首选推荐。

**主要内容：**

- **第一部分：数据系统基础**
  - 可靠性、可扩展性、可维护性
  - 数据模型和查询语言
  - 存储与检索
  - 编码与演化

- **第二部分：分布式数据**
  - 复制（Replication）
  - 分区（Partitioning）
  - 事务（Transactions）
  - 分布式系统的麻烦（故障、不可靠的网络、时钟）
  - 一致性与共识（Consensus）

- **第三部分：派生数据**
  - 批处理
  - 流处理
  - 数据系统的未来

#### 《分布式系统原理与范型》

**作者：** Andrew Tanenbaum, Maarten van Steen

**中文版：** [第2版](https://book.douban.com/subject/3108801/)

**英文版：** [第3版](https://book.douban.com/subject/26979326/)（可在线免费获取）

**难度：** 中级

**何时使用：** 传统教材，更系统化，适合想要更理论化学习的人

### 视频课程

#### MIT 6.824 - 分布式系统

**学校：** MIT

**讲师：** Robert Morris

**平台：** MIT 课程网站 / YouTube

**视频：** [2020年课程](https://www.youtube.com/playlist?list=PLrw6a1wE39_tb2fErI4-WkMbsvGQk9_UB)

**课程网站：** [Schedule and Labs](https://pdos.csail.mit.edu/6.824/schedule.html)

**难度：** 高级（研究生课程）

**为什么推荐：**

这是一门很好的在线视频课程。课程包含优秀的实验项目，让你实现实际的分布式系统。

**主题：**

- MapReduce
- GFS（Google File System）
- VMware FT（容错）
- Raft 共识算法
- Zookeeper
- Spanner（分布式事务）
- 区块链

**Lab 项目：**

- Lab 1: MapReduce
- Lab 2: Raft
- Lab 3: KV Store with Raft
- Lab 4: Sharded KV Store

### 在线资源

- [DDIA 读书笔记](https://github.com/Vonng/ddia) - 中文翻译和笔记
- [Papers We Love - Distributed Systems](https://github.com/papers-we-love/papers-we-love/tree/master/distributed_systems)
- [The Raft Consensus Algorithm](https://raft.github.io/) - Raft 可视化

## 论文阅读

学习分布式系统必然要求阅读论文。我们强烈建议出席你当地的 [Papers We Love](http://paperswelove.org/) 读书会。

### 必读论文

从 [MIT 6.824 论文清单](https://pdos.csail.mit.edu/6.824/schedule.html) 和 [这里的清单](http://dsrg.pdos.csail.mit.edu/papers/) 选择。

**经典论文：**

1. **MapReduce** - Google 的大规模数据处理
2. **GFS** - Google 文件系统
3. **Raft** - 易于理解的共识算法
4. **Paxos** - 经典共识算法
5. **Dynamo** - Amazon 的高可用键值存储
6. **Spanner** - Google 的全球分布式数据库
7. **CAP Theorem** - 一致性、可用性、分区容错性的权衡

## 练习

### MIT 6.824 Labs

**来源：** [MIT 6.824](https://pdos.csail.mit.edu/6.824/schedule.html)

**难度：** 高级

**预计时间：** 每个 Lab 20-40 小时

**主要 Labs：**

1. **MapReduce** - 实现分布式 MapReduce 框架
2. **Raft** - 实现 Raft 共识算法
3. **KV Store** - 基于 Raft 的容错键值存储
4. **Sharded KV Store** - 实现分片和数据迁移

**为什么重要：**

这些实验让你真正理解分布式系统的复杂性和挑战。是最有价值的学习经历之一。

### 其他实践项目

1. **实现简单的分布式系统**
   - 分布式锁
   - 领导选举
   - 分布式队列

2. **使用现有框架**
   - Docker + Kubernetes 部署
   - 使用 etcd、Consul
   - 玩转 Kafka、RabbitMQ

3. **性能测试**
   - 负载测试
   - 故障注入
   - 分析瓶颈

## 学习方法

### 推荐学习路径

1. **阅读《数据密集型应用系统设计》**
   - 按部就班阅读全书
   - 理解分布式系统的核心挑战
   - 这本书提供了优秀的全局视野

2. **观看 MIT 6.824 课程**
   - 配合论文阅读
   - 理解经典系统的设计
   - 关注设计权衡和折中

3. **阅读经典论文**
   - 至少读 5-10 篇重要论文
   - 理解问题、解决方案和权衡
   - 参加 Papers We Love 讨论

4. **完成 Labs**
   - 至少完成 Raft 实验
   - 如果时间允许,完成所有 6.824 Labs
   - 这些实验对理解至关重要

5. **深入专题**（可选）
   - 一致性模型
   - 分布式事务
   - 流处理系统
   - 区块链技术

### 时间分配建议

- **最少投入：** 100 小时（DDIA + 部分课程）
- **推荐投入：** 200-300 小时（包括 Labs）
- **深入学习：** 400+ 小时（所有 Labs + 论文 + 项目）

### 学习技巧

1. **理解权衡** - 分布式系统充满权衡，没有完美方案
2. **故障思维** - 思考一切可能出错的情况
3. **阅读论文** - 论文是分布式系统学习的核心
4. **动手实践** - 理论必须配合实践
5. **网络模拟** - 学会模拟网络延迟、丢包等

## 核心概念

### 分布式系统的挑战

1. **部分故障** - 系统的一部分可能故障
2. **不可靠的网络** - 消息可能延迟、丢失、重复
3. **不可靠的时钟** - 不同机器时钟不同步
4. **并发** - 多个操作同时进行

### 核心主题

1. **复制（Replication）**
   - 主从复制
   - 多主复制
   - 无主复制

2. **分区（Partitioning/Sharding）**
   - 键值分区
   - 范围分区
   - 再平衡

3. **一致性**
   - 强一致性
   - 最终一致性
   - 因果一致性

4. **共识（Consensus）**
   - Paxos
   - Raft
   - Zab

5. **事务**
   - ACID 属性
   - 两阶段提交（2PC）
   - 分布式事务

## 常见问题

### CAP 定理重要吗？

CAP 定理常被误解：

- **重要性：** 理解权衡很重要
- **误区：** CAP 不是三选二那么简单
- **现实：** 现代系统在 C 和 A 之间有细致的权衡

建议：理解 CAP 但不要过分简化。

### 需要实现 Raft 吗？

**强烈推荐：**

- Raft 是理解共识算法的最好方式
- MIT 6.824 的 Raft Lab 是最有价值的学习经历之一
- 即使不完成所有 Labs，也应该实现 Raft

### 微服务和分布式系统的关系？

微服务是分布式系统的一种应用：

- 学好分布式系统理论
- 理解微服务的挑战
- 知道何时应该（不应该）使用微服务

### 区块链是分布式系统吗？

是的：

- 区块链是特殊的分布式系统
- 应用了共识算法（PoW、PoS 等）
- 先学好经典分布式系统再学区块链

## 进阶学习

### 现代分布式系统

研究生产环境中的分布式系统：

- **Kubernetes** - 容器编排
- **Kafka** - 分布式流平台
- **Cassandra** - 分布式数据库
- **etcd** - 分布式键值存储（基于 Raft）

### 云计算

分布式系统与云计算紧密相关：

- AWS、Google Cloud、Azure 的服务
- 理解云上的分布式系统设计
- Serverless 架构

## 学习笔记

[在学习过程中可以在此添加个人笔记和关键见解]

## 进度跟踪

- [ ] 完成《数据密集型应用系统设计》全书阅读
- [ ] 观看 MIT 6.824 课程
- [ ] 阅读至少 5-10 篇经典论文
- [ ] 完成至少 Raft 实验
- [ ] 理解一致性、复制、分区的核心概念
- [ ] 理解共识算法的工作原理
- [ ] 复习和巩固

---

**恭喜：** 完成分布式系统模块后，你已经学完了计算机科学的9个核心主题！继续在实践中应用这些知识，并保持学习。
