# 编程语言与编译器

[English](README.md) | 简体中文

## 概述

编程语言设计、解析和编译器实现。本模块涵盖词法分析、语法分析、类型系统、代码生成和优化。

## 为何要学？

若你懂得编程语言和编译器如何工作，你就能写出更好的代码，更轻松地学习新的编程语言。

多数程序员学习编程语言的知识，而多数计算机科学家学习编程语言**相关**的知识。这使得计算机科学家比起程序员拥有显著的优势,即便在编程领域！因为他们的知识可以推而广之：相较只学习过特定编程语言的人，他们可以更深入更快速地理解新的编程语言。

> 不要做一个只写样板代码的程序员。相反，给用户和其他程序员创造工具。从纺织工业和钢铁工业中学习历史教训：你想制造机器和工具，还是操作这些机器？
>
> — Ras Bodik 在他的编译器课程伊始

## 前置要求

**推荐：**

- 编程 - 熟练掌握至少一门编程语言
- 数据结构 - 理解树、图等数据结构
- 算法 - 理解递归、图遍历等

## 编程语言

- **任何语言** - 用于实现编译器/解释器
- **推荐：** Java, C++, Rust, Python

## 推荐资源

### 教材

#### *Crafting Interpreters*

**作者：** Robert Nystrom

**在线版：** [免费阅读](https://craftinginterpreters.com/contents.html)

**难度：** 初级到中级

**为什么选择这本书：**

这本书条理清晰，富有趣味性，非常适合那些想要更好地理解语言和语言工具的人。我们建议你花时间读完整本书，并尝试任何一个感兴趣的「挑战」。

**主要内容：**

- 从零实现两个完整的解释器
- Lox 编程语言设计
- **第一部分：** 用 Java 实现树遍历解释器
- **第二部分：** 用 C 实现字节码虚拟机

**为什么推荐：**

- 实践导向，代码优先
- 清晰的讲解和示例
- 涵盖完整的实现过程
- 适合自学

#### 《编译原理》（龙书）

**作者：** Alfred Aho, Monica Lam, Ravi Sethi, Jeffrey Ullman

**中文版：** [《编译原理》第2版](https://book.douban.com/subject/3296317/)

**难度：** 中级到高级

**为什么选择：**

这本书不是为自学者而设计的，而是供教师从中挑选一些主题用于 1-2 学期的教学。如果你选择使用龙书进行自学，你需要从中甄选主题，而且最好是在导师的帮助下。

**建议：** 依据某个视频课程来设定学习的结构，然后按需从龙书中获取深入的内容。

### 视频课程

#### Alex Aiken 的编译器课程

**讲师：** Alex Aiken

**学校：** Stanford University

**平台：** edX

**链接：** [Compilers](https://www.edx.org/course/compilers)

**描述：** 优秀的编译器课程，配合龙书使用效果很好

**主题：**

- 词法分析和语法分析
- 语义分析和类型检查
- 运行时环境
- 代码生成和优化

### 在线资源

- [Crafting Interpreters](https://craftinginterpreters.com/) - 完整免费在线书
- [Build Your Own Lisp](http://www.buildyourownlisp.com/) - 用 C 实现 Lisp
- [Writing An Interpreter In Go](https://interpreterbook.com/) - 用 Go 实现解释器

## 练习

### Crafting Interpreters 挑战

**来源：** 书中的挑战题

**难度：** 中级到高级

**挑战示例：**

- 添加新的语言特性
- 优化性能
- 改进错误报告
- 实现新的数据类型

**建议：** 至少尝试几个挑战，它们能加深理解。

### 自己实现编程语言

**项目：** 设计并实现自己的编程语言

**难度：** 高级

**预计时间：** 100+ 小时

**建议：**

1. **简单解释器** - 从简单的表达式求值开始
2. **添加特性** - 逐步添加变量、函数、控制流
3. **完整语言** - 实现完整的编程语言

**参考项目：**

- Scheme 解释器
- Lisp 解释器
- 简单的脚本语言
- 领域特定语言（DSL）

### 编译器相关项目

**其他实践：**

1. **为现有语言贡献** - 为 Python、Ruby 等贡献代码
2. **静态分析工具** - 实现 linter 或代码检查工具
3. **转译器** - 实现语言间的转换工具
4. **优化器** - 实现简单的代码优化器

## 学习方法

### 推荐学习路径

**路径 A：实践优先（推荐）**

1. **阅读并实现 *Crafting Interpreters***
   - 跟随书中实现第一个解释器（Java）
   - 完成第二个解释器（C）
   - 尝试书中的挑战

2. **学习理论**
   - 观看 Alex Aiken 的课程
   - 补充阅读龙书相关章节
   - 理解形式化理论

3. **深入项目**
   - 设计自己的语言
   - 实现完整的编译器
   - 研究现代编译器

**路径 B：理论优先**

1. **观看编译器课程**
   - Alex Aiken 的课程
   - 理解基本概念

2. **阅读龙书**
   - 选择性阅读关键章节
   - 重点：词法分析、语法分析、语义分析

3. **实践**
   - 实现 *Crafting Interpreters*
   - 完成课程项目

### 时间分配建议

- **最少投入：** 100 小时（*Crafting Interpreters*）
- **推荐投入：** 150-200 小时（包括理论学习）
- **深入学习：** 250+ 小时（自己的语言 + 高级主题）

### 学习技巧

1. **从简单开始** - 不要一开始就想实现 C++ 编译器
2. **增量开发** - 逐步添加特性，每次都保持可运行
3. **测试驱动** - 为你的语言写测试用例
4. **研究现有实现** - 阅读优秀的开源编译器代码
5. **理解权衡** - 编译器设计充满权衡，理解背后的原因

## 核心主题

### 前端（分析阶段）

1. **词法分析** - 将源代码转换为标记流
2. **语法分析** - 构建抽象语法树（AST）
3. **语义分析** - 类型检查、作用域分析
4. **中间表示** - 生成 IR

### 后端（综合阶段）

1. **代码生成** - 从 IR 生成目标代码
2. **优化** - 各种优化技术
3. **寄存器分配** - 高效使用寄存器
4. **目标代码** - 生成可执行代码或字节码

### 语言特性

1. **类型系统** - 静态/动态类型
2. **内存管理** - 垃圾回收、手动管理
3. **并发** - 语言级并发支持
4. **元编程** - 宏、反射等

## 常见问题

### 为什么你们还在推荐龙书？

龙书依旧是内容最为完整的编译器单本书籍。由于过分强调一些如今不够时新的主题的细节，比如解析，这本书招致了恶评。然而事实上，这本书从未打算供人一页一页的学习，而仅仅是为了给教师准备一门课程提供足够的材料。

类似地，自学者可以从书中量身按需挑选主题，或者最好依照公开课授课教师在课程大纲中的建议。

### 需要深入学习解析理论吗？

不一定：

- **了解即可：** LL、LR 解析理论
- **重点掌握：** 递归下降、Parser Combinator
- **实用工具：** ANTLR、Bison 等工具

现代编译器通常使用手写递归下降解析器，而不是解析生成器。

### 实现解释器还是编译器？

**建议先实现解释器：**

- 更简单，更快看到结果
- 容易调试
- 理解核心概念

**之后再实现编译器：**

- 学习代码生成
- 理解优化技术
- 更接近生产环境

### 需要学习 LLVM 吗？

看你的目标：

- **学习编译器原理** - 不必使用 LLVM
- **实现生产级编译器** - LLVM 是很好的后端
- **想快速原型** - 使用 LLVM 可以专注于前端

建议：先实现简单的完整编译器，再学习 LLVM。

### 函数式语言 vs 命令式语言？

**先实现简单的命令式语言：**

- 概念更直观
- 容易理解控制流

**再尝试函数式语言：**

- 理解不同的编程范式
- 学习类型推导
- 实现模式匹配

## 深入学习

### 高级主题

- **类型理论** - 类型系统的理论基础
- **程序分析** - 静态分析、数据流分析
- **JIT 编译** - 即时编译技术
- **垃圾回收** - 各种 GC 算法
- **并行编译** - 利用多核加速编译

### 现代编译器

研究现代生产级编译器的源码：

- **Rust** - rustc（优秀的错误信息）
- **Go** - gc（快速编译）
- **V8** - JavaScript JIT 编译器
- **LLVM** - 模块化编译器基础设施

## 学习笔记

[在学习过程中可以在此添加个人笔记和关键见解]

## 进度跟踪

- [ ] 完成 *Crafting Interpreters* 并实现两个解释器
- [ ] 观看 Alex Aiken 的编译器课程
- [ ] 理解词法分析、语法分析、语义分析
- [ ] 理解代码生成和优化基础
- [ ] 实现自己设计的编程语言（可选但推荐）
- [ ] 复习和巩固

---

**下一步：** 学完编程语言与编译器后，你对编程的理解会提升到新的层次。可以将这些知识应用到任何编程项目中。
